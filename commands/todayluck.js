const { SlashCommandBuilder } = require('discord.js');

module.exports = {
	data: new SlashCommandBuilder()
		.setName('todayluck')
		.setDescription('ä»Šæ—¥ã®é‹å‹¢ã‚’æ•™ãˆã‚‹ã‚ˆ')
		.addStringOption(option =>
			option
				.setName('type')
				.setDescription('é‹å‹¢ã®ã‚¸ãƒ£ãƒ³ãƒ«ã‚’é¸ã‚“ã§ã­')
				.setRequired(false)
				.addChoices(
					{ name: 'æ—¥å¸¸é‹', value: 'normal' },
					{ name: 'ã‚²ãƒ¼ãƒãƒ¼é‹', value: 'gamer' },
					{ name: 'ãƒ‘ãƒãƒ³ã‚³é‹', value: 'pachinko' }
				)
		),

	async execute(client, interaction) {
		// ã¾ãšã€Œå ã„ä¸­â€¦â€¦ã€ã‚’è¿”ä¿¡ï¼ˆephemeral: false ã§å…¨ä½“ã«è¡¨ç¤ºï¼‰
		await interaction.reply({ content: 'ğŸ”® å ã„ä¸­â€¦â€¦', ephemeral: false });

		// é‹å‹¢ãƒ©ãƒ³ã‚¯ã”ã¨ã®å„ç¨®ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆnormal: æ—¥å¸¸ / gamer: ã‚²ãƒ¼ãƒãƒ¼ / pachinko: ãƒ‘ãƒãƒ³ã‚«ã‚¹ï¼‰
		const fortunes = [
			{
				rank: "âœ¨ å¤§å‰ âœ¨",
				comments: {
					normal: [
						"ä»Šæ—¥ã¯ä½•ã‚’ã—ã¦ã‚‚ãƒ„ã‚¤ã¦ã‚‹ï¼æ€ã„ãã£ã¦æŒ‘æˆ¦ã—ã¦ã¿ã‚ˆã†ï¼",
						"é‹å‘½ãŒå‘³æ–¹ã—ã¦ãã‚Œã‚‹æ—¥ï¼æ€ã„åˆ‡ã£ã¦å‹•ã“ã†ï¼",
						"å…¨ã¦ãŒé †èª¿ã«é€²ã‚€ã¯ãšï¼"
					],
					gamer: [
						"å‹ç‡çˆ†ä¸ŠãŒã‚Šï¼ã‚¨ã‚¤ãƒ ã‚‚ç«‹ã¡å›ã‚Šã‚‚ç¥ãŒã‹ã£ã¦ã‚‹ãï¼",
						"å‘³æ–¹ã‚¬ãƒãƒ£å¤§æˆåŠŸï¼ç„¡åŒã§ãã‚‹äºˆæ„Ÿï¼",
						"ãƒ©ãƒ³ã‚¯ã‚‚ã‚¬ãƒãƒ£ã‚‚å…¨éƒ¨ç¥å¼•ãï¼"
					],
					pachinko: [
						"ä¸‡æšã‚³ãƒ¼ã‚¹ï¼ä»Šæ—¥ã¯æœã‹ã‚‰é–‰åº—ã¾ã§è¡Œãã¹ãæ—¥ï¼",
						"å³æ‰“ã¡ãŒæ­¢ã¾ã‚‰ãªã„ï¼ä»Šæ—¥ã®ä¸»å½¹ã¯å›ã ï¼",
						"å…¨å›è»¢æ¼”å‡ºã‚’å¼•ã‘ã‚‹ã‹ã‚‚ï¼ï¼Ÿè¡Œãã—ã‹ãªã„ï¼"
					]
				}
			},
			{
				rank: "ğŸ˜Š ä¸­å‰ ğŸ˜Š",
				comments: {
					normal: [
						"å°‘ã—ã ã‘ã„ã„ã“ã¨ãŒã‚ã‚Šãã†ã€‚æ°—æ¥½ã«æ¥½ã—ã‚‚ã†ï¼",
						"æ„å¤–ãªå¬‰ã—ã„ã“ã¨ãŒã‚ã‚‹ã‹ã‚‚ã€‚",
						"äººã®å„ªã—ã•ã«è§¦ã‚Œã‚‹æ—¥ã‹ã‚‚ï¼"
					],
					gamer: [
						"å‘³æ–¹é‹ãã“ãã“ï¼è‡ªåˆ†ã®è…•æ¬¡ç¬¬ã§å‹ã¦ã‚‹ï¼",
						"ä»Šæ—¥ã®ç«‹ã¡å›ã‚Šã¯å®‰å®šæ„ŸæŠœç¾¤ï¼",
						"å ±é…¬ã‚‚è‰¯ã„æ„Ÿã˜ã«ç¨¼ã’ãã†ï¼"
					],
					pachinko: [
						"ä»Šæ—¥ã¯ãƒ—ãƒ©ã‚¹åŸŸï¼æ·±è¿½ã„ã›ãšé€ƒã’åˆ‡ã‚Œï¼",
						"æ³¢ã«ä¹—ã‚Œã‚Œã°å‹ã¦ã‚‹ï¼å¼•ãéš›ãŒé‡è¦ï¼",
						"2ä¸‡å‹ã¡ãã‚‰ã„ã§å¸°ã‚ŒãŸã‚‰ä¸Šå‡ºæ¥ï¼"
					]
				}
			},
			{
				rank: "ğŸ˜Œ å°å‰ ğŸ˜Œ",
				comments: {
					normal: [
						"ç©ã‚„ã‹ãªä¸€æ—¥ã€‚ç„¡ç†ã›ãšãƒã‚¤ãƒšãƒ¼ã‚¹ã«ã„ã“ã†ã€‚",
						"ãƒªãƒ©ãƒƒã‚¯ã‚¹ã—ã¦éã”ã›ã‚‹æ—¥ã€‚",
						"ã‚³ãƒ¼ãƒ’ãƒ¼ã§ã‚‚é£²ã‚“ã§ã»ã£ã¨ä¸€æ¯ã€‚"
					],
					gamer: [
						"ã‚½ãƒ­ãƒ—ãƒ¬ã‚¤ã§ã¾ã£ãŸã‚ŠãŒå‰ã€‚",
						"ãƒ‡ã‚¤ãƒªãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã ã‘æ¸ˆã¾ã›ã‚ˆã†ã€‚",
						"ä»Šã¯ç·´ç¿’ã«é›†ä¸­ã™ã‚‹ã¨è‰¯ã„ã‹ã‚‚ã€‚"
					],
					pachinko: [
						"ä»Šæ—¥ã¯éŠã³æ‰“ã¡ã§ï¼è² ã‘ã¦ã‚‚ã‚¹ãƒˆãƒ¬ã‚¹å°‘ãªã‚ã€‚",
						"æ‰“ã¡ã«è¡Œãã‚ˆã‚Šå®¶ã§ã‚¢ãƒ‹ãƒ¡ãŒæ­£è§£ã‹ã‚‚ã€‚",
						"ç”˜ãƒ‡ã‚¸ã§æ°—æ¥½ã«éã”ã™ã®ãŒâ—ã€‚"
					]
				}
			},
			{
				rank: "ğŸ˜ æœ«å‰ ğŸ˜",
				comments: {
					normal: [
						"ä½•ã‚‚èµ·ããªã„ã®ãŒå¹¸ã›ã€‚å¹³å‡¡ã‚’æ¥½ã—ã‚‚ã†ã€‚",
						"å°ã•ãªã“ã¨ã«æ„Ÿè¬ã™ã‚‹æ—¥ã‹ã‚‚ã€‚",
						"æ‚ªãã¯ãªã„ã‘ã©æœŸå¾…ã—ã™ããªã„ã§ã€‚"
					],
					gamer: [
						"ä»Šæ—¥ã¯ç·´ç¿’æ—¥å’Œã€‚ãƒ©ãƒ³ã‚¯ã¯ãŠä¼‘ã¿ã—ã‚ˆã†ã€‚",
						"å‘³æ–¹ã¯å½“ã¦ã«ã—ãªã„ã§ç«‹ã¡å›ã‚ã†ã€‚",
						"ãƒ­ã‚°ãƒœã ã‘å–ã£ã¦ãŠãã®ã‚‚æ‰‹ã€‚"
					],
					pachinko: [
						"è¡Œã£ã¦ã‚‚è¡Œã‹ãªãã¦ã‚‚å¤‰ã‚ã‚‰ã‚“ã‹ã‚‚ãªâ€¦ã€‚",
						"ä»Šæ—¥æ‰“ã¤ãªã‚‰è»½ãæ§˜å­è¦‹ç¨‹åº¦ã§ã€‚",
						"ãƒãƒ¼ãƒ’ãƒƒãƒˆã§å¸°ã‚‹å¯èƒ½æ€§ã‚¢ãƒªã€‚"
					]
				}
			},
			{
				rank: "ğŸ˜… å‡¶ ğŸ˜…",
				comments: {
					normal: [
						"å°ã•ãªãƒˆãƒ©ãƒ–ãƒ«ã«æ³¨æ„ã€‚ä½™è£•ã‚’æŒã£ã¦è¡Œå‹•ã—ã‚ˆã†ã€‚",
						"ç„¦ã‚‹ã¨æ‚ªå¾ªç’°ã€‚æ·±å‘¼å¸ã‚’å¿˜ã‚Œãšã«ã€‚",
						"å‡ºã‹ã‘ã‚‹ãªã‚‰å¿µå…¥ã‚Šã«æº–å‚™ã—ã¦ã€‚"
					],
					gamer: [
						"å‘³æ–¹ã‚¬ãƒãƒ£åœ°ç„æ³¨æ„ï¼ã‚½ãƒ­ãƒ©ãƒ³ã‚¯ã¯é¿ã‘ã¦ï¼",
						"ãƒ©ã‚°ã«æ‚©ã¾ã•ã‚Œã‚‹ã‹ã‚‚â€¦å›ç·šãƒã‚§ãƒƒã‚¯æ¨å¥¨ã€‚",
						"æ­¦å™¨é‹ãŒæ‚ªã„æ—¥ã€‚æ§‹æˆå¤‰ãˆã¦ã¿ã¦ã¯ï¼Ÿ"
					],
					pachinko: [
						"ãƒãƒã‚Šåœ°ç„ã®å§‹ã¾ã‚Šã‹ã‚‚â€¦å›ã™æ‰‹ãŒéœ‡ãˆã‚‹ï¼",
						"ä»Šæ—¥ã¯æŠ•è³‡ãŒæ­¢ã¾ã‚‰ãªã„â€¦å†·é™ã•ã‚’å¿˜ã‚Œãšã«ã€‚",
						"STã‚¹ãƒ«ãƒ¼3é€£ç™ºã¨ã‹ã‚ã‚Šãã†ã€‚"
					]
				}
			},
			{
				rank: "ğŸ’€ å¤§å‡¶ ğŸ’€",
				comments: {
					normal: [
						"ä»Šæ—¥ã¯é™ã‹ã«éã”ã™ã®ãŒå‰ã€‚ç„¡ç†ã—ãªã„ã§ã­ã€‚",
						"å¯ã¦éã”ã›ã€‚å¤–å‡ºã¯éæ¨å¥¨ã€‚",
						"ä½™è¨ˆãªã“ã¨ã¯ã›ãšç¾çŠ¶ç¶­æŒï¼"
					],
					gamer: [
						"ãƒã‚°ãƒ»ãƒ©ã‚°ãƒ»å‘³æ–¹åœ°é›·ã®ä¸‰é‡è‹¦â€¦ï¼",
						"ä»Šæ—¥ã®ãƒ©ãƒ³ã‚¯ãƒã¯åœ°ç„ï¼",
						"ã‚¨ã‚¤ãƒ ãŒè¿·å­ã«ãªã‚‹æ—¥ã€‚æ„Ÿåº¦ã‚‚ã‚ºãƒ¬ã¦ã‚‹æ°—ãŒã™ã‚‹â€¦"
					],
					pachinko: [
						"å¤©äº•ä¸€ç›´ç·šã€‚è²¡å¸ƒã¨å¿ƒã®HPã‚’å¤§åˆ‡ã«ã€‚",
						"ç¢ºå¤‰å³è½ã¡ã€‚ä½•ã‚’å¼•ã„ã¦ã‚‚ä¼¸ã³ãªã„ï¼",
						"å¸°ã‚‹é ƒã«ã¯è²¡å¸ƒãŒç©ºã£ã½ã‹ã‚‚â€¦ã€‚"
					]
				}
			}
		];

		// é¸æŠã•ã‚ŒãŸã‚¸ãƒ£ãƒ³ãƒ«ã‚’å–å¾—ï¼ˆãªã‘ã‚Œã°ãƒ©ãƒ³ãƒ€ãƒ ï¼‰
		const selectedType = interaction.options.getString('type') ||
			['normal', 'gamer', 'pachinko'][Math.floor(Math.random() * 3)];

		// å°‘ã—é…ã‚‰ã›ã¦æ¼”å‡ºï¼ˆ1.5ç§’ï¼‰
		await new Promise(resolve => setTimeout(resolve, 1500));

		// ãƒ©ãƒ³ãƒ€ãƒ ã«é‹å‹¢ã‚’é¸ã¶
		const result = fortunes[Math.floor(Math.random() * fortunes.length)];

		// ãƒ©ãƒ³ãƒ€ãƒ ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’é¸ã¶
		const comments = result.comments[selectedType];
		const comment = comments[Math.floor(Math.random() * comments.length)];

		const username = interaction.user.username;

		const typeNameMap = {
			normal: "æ—¥å¸¸é‹",
			gamer: "ã‚²ãƒ¼ãƒãƒ¼é‹",
			pachinko: "ãƒ‘ãƒãƒ³ã‚³é‹"
		};

		// è¿”ä¿¡ã‚’ç·¨é›†ã—ã¦çµæœã‚’è¡¨ç¤º
		await interaction.editReply({
			content: `ğŸ”® ${username}ã•ã‚“ã®**${typeNameMap[selectedType]}**ã¯...\n**${result.rank}**\n${comment}`
		});
	},
};
